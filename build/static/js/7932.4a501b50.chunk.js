"use strict";(self.webpackChunklightence_admin=self.webpackChunklightence_admin||[]).push([[7932],{43286(e,n,t){t.d(n,{$x:()=>u,DO:()=>p});var a,i,r,d,o=t(57528),l=t(94574),s=t(62791),c=t(62058),h=t(64435);const u=(0,l.Ay)(h.A)(a||(a=(0,o.A)(["\n  & > .ant-space-item:last-of-type {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n"]))),p=((0,l.Ay)(c.A)(i||(i=(0,o.A)(["\n  font-size: 1.25rem;\n  color: #666;\n\n  @media only screen and (min-width: 768px) {\n    font-size: 1.5rem;\n  }\n"]))),l.Ay.button(r||(r=(0,o.A)(["\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  color: #999;\n  font-size: 1rem;\n  margin-left: 0.5rem;\n  display: flex; /* Ensure it aligns properly with the input */\n  align-items: center;\n  height: 100%; /* Match the height of the input */\n  padding: 0; /* Remove extra padding */\n\n  &:hover {\n    color: #333;\n  }\n"]))),(0,l.Ay)(s.a.Search)(d||(d=(0,o.A)(["\n  border: 2px solid #c6d9eb;\n  border-radius: 1.5rem;\n  background: #ffffff;\n  padding: 0.5rem 1rem;\n  width: 100%; /* Default to 100% width for mobile devices */\n  max-width: 450px; /* Set a maximum width */\n  margin: 0 auto; /* Center horizontally */\n  box-shadow: none; /* Remove box shadow to avoid enlarging effect */\n  display: flex; /* Use flex to align items properly */\n\n  &:focus {\n    border-color: #a2b8d7;\n    outline: none;\n  }\n\n  .ant-input-prefix {\n    margin-right: 0.5rem;\n  }\n\n  .ant-input-group-addon {\n    display: none;\n  }\n\n  input {\n    height: auto;\n    padding: 0.5rem;\n    border: none;\n    outline: none;\n    background: transparent;\n    font-weight: bold;\n    font-size: 14px; /* Slightly increased font size for better readability */\n    color: #333;\n  }\n\n  .clear-button {\n    display: flex;\n    align-items: center;\n    margin-left: 0; /* Remove margin if not needed */\n  }\n\n  @media only screen and (min-width: 576px) {\n    width: 75%; /* Adjust width for small tablets */\n  }\n\n  @media only screen and (min-width: 768px) {\n    width: 50%; /* Adjust width for tablets */\n  }\n\n  @media only screen and (min-width: 992px) {\n    width: 450px; /* Use the fixed width for larger screens */\n  }\n"]))))},55551(e,n,t){t.r(n),t.d(n,{default:()=>B});var a,i=t(65043),r=t(45907),d=t(30460),o=t(8387),l=t(40854),s=t.n(l),c=t(89379),h=t(57528),u=t(19160),p=t(74684),f=t(49092),g=t(25389),x=t(64435),m=t(89421),v=t(47419),y=t(11645),A=t(35696),w=t(36497),_=t(64124),j=t(62058),C=t(16854),S=t.n(C),b=t(43286),O=t(73216),I=t(94574),k=t(83722),E=t(70579);const{Text:H}=r.A,L={current:1,pageSize:100},D={calhiv:"C/ALHIV",hei:"HEI",cwlhiv:"C/WLHIV",agyw:"AGYW",csv:"C/SV",cfsw:"CFSW",abym:"ABYM",caahh:"CAAHH",caichh:"CAICHH",caich:"CAICH",calwd:"CALWD",caifhh:"CAIFHH",muc:"MUC",pbfw:"PBFW"},F={calhiv:"Children and Adolescents Living with HIV",hei:"HIV Exposed Infants",cwlhiv:"Children and Women Living with HIV",agyw:"Adolescent Girls and Young Women",csv:"Children Survivors of Violence",cfsw:"Children of Female Sex Workers",abym:"Adolescent Boys and Young Men",caahh:"Child/Adolescent in Aged Headed Household",caichh:"Child/Adolescent in Chronically Ill Headed Household",caich:"Child/Adolescent in Child Headed Household",calwd:"Child/Adolescent Living with Disability",caifhh:"Child/Adolescent in Female Headed Household",muc:"Malnourished Under 5 Children",pbfw:"Pregnant and Breastfeeding Women"},R={caahh:"child_adolescent_in_aged_headed_household",caichh:"child_adolescent_in_chronically_ill_headed_household",caich:"child_adolescent_in_child_headed_household",calwd:"child_adolescent_living_with_disability",caifhh:"child_adolescent_in_female_headed_household",muc:"under_5_malnourished",pbfw:"pbfw"},T=I.Ay.div(a||(a=(0,h.A)(["\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 16px;\n  margin-bottom: 16px;\n"]))),W=()=>{var e;const[n,t]=(0,i.useState)([]),[a,r]=(0,i.useState)([]),[d,l]=(0,i.useState)([]),[h,C]=(0,i.useState)({data:[],pagination:L,loading:!1}),{t:I}=(0,f.B)(),[W,B]=(0,i.useState)(""),[P,z]=(0,i.useState)(!1),[U,V]=(0,i.useState)(null),N=(0,i.useRef)(null),M=(0,O.Zp)(),[q,K]=(0,i.useState)(""),[Y,G]=(0,i.useState)(""),[$,X]=(0,i.useState)(!1),[Z,J]=(0,i.useState)({}),[Q,ee]=(0,i.useState)(""),[ne,te]=(0,i.useState)(Object.keys(D).reduce((e,n)=>(0,c.A)((0,c.A)({},e),{},{[n]:"all"}),{}));(0,i.useEffect)(()=>{(async()=>{try{const e=await s().get("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BASE_URL,"/users/me"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});V(e.data.data)}catch(e){console.error("Error fetching user data:",e)}})()},[]);const[ae,ie]=(0,i.useState)([{key:"reason",value:""}]);(0,i.useEffect)(()=>{const e=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(U)try{var n;z(!0);const a=(null===(n=ae.find(e=>"reason"===e.key))||void 0===n?void 0:n.value)||"",i=await s().get("https://ecapplus.server.dqa.bluecodeltd.com/child/vcas-archived-register/".concat(null===U||void 0===U?void 0:U.location),{params:{reason:a}});e&&r(i.data.data),t(i.data.data),l(i.data.data),console.log("Fetched households with filter:",i.data.data)}catch(a){console.error("Error fetching households data:",a)}finally{z(!1)}};e(!0),e()},[U,ae]),(0,i.useEffect)(()=>{const e=W.toLowerCase(),t=n.filter(n=>{var t,a;const i=[n.uid,n.firstname,n.lastname,n.vca_gender,n.homeaddress,n.facility,n.province,n.district,n.ward,n.calhiv,n.hei,n.cwlhiv,n.agyw,n.csv,n.cfsw,n.abym,n.vl_suppressed,n.child_adolescent_in_aged_headed_household,n.child_adolescent_in_chronically_ill_headed_household,n.child_adolescent_in_child_headed_household,n.child_adolescent_living_with_disability,n.child_adolescent_in_female_headed_household,n.under_5_malnourished,n.pbfw,n.reason].filter(Boolean).join(" ").toLowerCase().includes(e),r=Object.entries(ne).every(e=>{let[t,a]=e;if("all"===a)return!0;let i=t;t in R&&(i=R[t]);const r=n[i];return null!==r&&("yes"===a?"1"===r||"true"===r:"0"===r||"false"===r)}),d=""===(null===(t=ae.find(e=>"reason"===e.key))||void 0===t?void 0:t.value)||n.reason===(null===(a=ae.find(e=>"reason"===e.key))||void 0===a?void 0:a.value);return i&&r&&d});l(t);const a=t.map((e,n)=>({key:n,unique_id:e.uid,name:"".concat(e.firstname," ").concat(e.lastname),gender:e.vca_gender,age:re(e.birthdate),address:{homeaddress:e.homeaddress,facility:e.facility,province:e.province,district:e.district,ward:e.ward}}));C(e=>({data:a,pagination:(0,c.A)((0,c.A)({},e.pagination),{},{current:1}),loading:!1}))},[W,n,ne,ae]);const re=e=>{if(!e)return 0;const n=[/^(\d{1,2})-(\d{1,2})-(\d{4})$/,/^(\d{4})-(\d{1,2})-(\d{1,2})$/,/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/];let t=null;for(const d of n){const a=e.match(d);if(a){t=d===n[0]?new Date(parseInt(a[3]),parseInt(a[2])-1,parseInt(a[1])):d===n[1]?new Date(parseInt(a[1]),parseInt(a[2])-1,parseInt(a[3])):new Date(parseInt(a[3]),parseInt(a[1])-1,parseInt(a[2]));break}}if(!t||isNaN(t.getTime()))return console.warn("Invalid date format: ".concat(e)),0;const a=new Date;let i=a.getFullYear()-t.getFullYear();const r=a.getMonth()-t.getMonth();return(r<0||0===r&&a.getDate()<t.getDate())&&i--,i},de=(e,n,t)=>{n(),K(e[0]),G(t)},oe=e=>({filterDropdown:t=>{let{setSelectedKeys:a,selectedKeys:i,confirm:r,clearFilters:d,close:o}=t;return(0,E.jsxs)("div",{style:{padding:8},children:[(0,E.jsx)(g.A,{ref:N,placeholder:"Search ".concat(e),value:i[0],onChange:t=>{const i=t.target.value;if(a(i?[i]:[]),"address"===e){const e=["homeaddress","facility","province","district","ward"];let t="";if(i&&n.length>0){const a=n[0];for(const n of e){var r;if(null!==(r=a[n])&&void 0!==r&&r.toString().toLowerCase().includes(i.toLowerCase())){t=n.charAt(0).toUpperCase()+n.slice(1);break}}}ee(t)}},onPressEnter:()=>de(i,r,e),style:{marginBottom:8,display:"block"}}),(0,E.jsxs)(x.A,{children:[(0,E.jsx)(m.A,{type:"primary",onClick:()=>{de(i,r,e),J(n=>(0,c.A)((0,c.A)({},n),{},{[e]:i[0]||""}))},icon:(0,E.jsx)(j.A,{}),size:"small",style:{width:95},children:"Search"}),(0,E.jsx)(m.A,{type:"primary",size:"small",onClick:()=>{d&&(d(),K(""),G(""),J(n=>{const t=(0,c.A)({},n);return delete t[e],t}),"address"===e&&ee(""),r({closeDropdown:!1}))},style:{width:125},children:"Reset column"}),(0,E.jsx)(m.A,{type:"link",size:"small",onClick:o,children:"X"})]})]})},filterIcon:e=>(0,E.jsx)(j.A,{style:{color:e?"#1890ff":void 0}}),onFilter:(n,t)=>{const a=t[e],i=String(n).toLowerCase();if("address"===e){var r;const e=Object.values(t.address).filter(Boolean).join(" ").toLowerCase();return!(null===(r=t.address.ward)||void 0===r||!r.toLowerCase().includes(i))||e.includes(i)}return"unique_id"===e||"gender"===e||"age"===e?!!a&&String(a).toLowerCase()===i:!!a&&String(a).toLowerCase().includes(i)},render:(n,t)=>{if("address"===e){const n=["Address: ".concat(t.address.homeaddress||""),"Facility: ".concat(t.address.facility||""),"Province: ".concat(t.address.province||""),"District: ".concat(t.address.district||""),"Ward: ".concat(t.address.ward||"")].filter(e=>!e.endsWith(": "));return(0,E.jsx)("div",{children:n.map((n,t)=>(0,E.jsx)("div",{children:Y===e&&q&&n.toLowerCase().includes(q.toLowerCase())?(0,E.jsx)(S(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[q],autoEscape:!0,textToHighlight:n}):n},t))})}return Y===e?(0,E.jsx)(S(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[q],autoEscape:!0,textToHighlight:n?n.toString():""}):n}}),le=[(0,c.A)({title:I("Unique ID"),dataIndex:"unique_id",width:"10%"},oe("unique_id")),(0,c.A)({title:I("Full Name"),dataIndex:"name",width:"15%"},oe("name")),(0,c.A)({title:I("Gender"),dataIndex:"gender",width:"10%"},oe("gender")),(0,c.A)({title:I("Age"),dataIndex:"age",width:"10%"},oe("age")),(0,c.A)({title:I("Household Details"),dataIndex:"address",width:"35%"},oe("address")),{title:I("Applied Filters & Search"),dataIndex:"appliedFilters",width:"20%",render:()=>{var e;const n=Object.entries(ne).filter(e=>{let[,n]=e;return"all"!==n}).map(e=>{let[n]=e;return D[n]}),t=(null===(e=ae.find(e=>"reason"===e.key))||void 0===e?void 0:e.value)||"",a=Object.entries(Z).filter(e=>{let[,n]=e;return""!==n}).map(e=>{let[n,t]=e;return"address"===n?"".concat(Q,": ").concat(t):"".concat(n,": ").concat(t)}),i=[...n,...t?["".concat(t)]:[],...a];return(0,E.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:i.map(e=>(0,E.jsx)(o.A,{color:"cyan",children:e},e))})}},{title:I("Actions"),width:"10%",dataIndex:"",render:(e,t)=>(0,E.jsx)(p.S,{type:"primary",onClick:()=>(e=>{const t=n.find(n=>n.uid===e);M("/profile/vca-profile/".concat(encodeURIComponent(e)),{state:{vca:t}})})(t.unique_id),children:I("View")})}];return(0,E.jsxs)("div",{children:[(0,E.jsxs)(v.A,{justify:"space-between",align:"middle",style:{marginBottom:"16px"},children:[(0,E.jsx)(y.A,{children:(0,E.jsx)(A.A,{title:I("You can search by Unique ID, Full Name, Gender, and other fields."),children:(0,E.jsx)(b.DO,{placeholder:I("Global Search"),value:W,onChange:e=>B(e.target.value),style:{marginRight:"16px"}})})}),(0,E.jsxs)(y.A,{span:24,children:[(0,E.jsx)("h5",{style:{fontSize:"20px",margin:"16px 16px 8px 0"},children:I("Filter by Sub Population")}),(0,E.jsxs)(v.A,{align:"middle",style:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap"},children:[Object.entries(D).map(e=>{let[n,t]=e;return(0,E.jsxs)("div",{style:{marginRight:"16px",marginBottom:"1px",display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[(0,E.jsx)("span",{style:{fontSize:"12px"},children:t}),(0,E.jsxs)(w.A,{style:{width:"100px"},value:ne[n],onChange:e=>{return t=n,a=e,void te(e=>(0,c.A)((0,c.A)({},e),{},{[t]:a}));var t,a},children:[(0,E.jsx)(w.A.Option,{value:"all",children:I("All")}),(0,E.jsx)(w.A.Option,{value:"yes",children:I("Yes")}),(0,E.jsx)(w.A.Option,{value:"no",children:I("No")})]})]},n)}),(0,E.jsx)("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap",alignItems:"flex-start"},children:(0,E.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[(0,E.jsxs)("span",{style:{fontSize:"12px",paddingBottom:"0px",textAlign:"center"},children:[I("Filter by Graduation")," ",(0,E.jsx)(o.A,{color:"cyan",children:" New "})]}),(0,E.jsx)("span",{children:(0,E.jsxs)(w.A,{style:{width:300,marginLeft:1},value:Array.isArray(ae)&&(null===(e=ae.find(e=>"reason"===e.key))||void 0===e?void 0:e.value)||void 0,onChange:e=>((e,n)=>{ie(t=>t.map(t=>t.key===e?(0,c.A)((0,c.A)({},t),{},{value:n}):t))})("reason",e),placeholder:"Select Option",dropdownRender:e=>(0,E.jsx)("div",{style:{fontWeight:"normal"},children:e}),children:[(0,E.jsx)(w.A.Option,{value:"Graduated (Household has met the graduation benchmarks in ALL domains)",children:"Met ALL graduation benchmarks"}),(0,E.jsx)(w.A.Option,{value:"Exited without graduation",children:"Exited without graduation"}),(0,E.jsx)(w.A.Option,{value:"Transferred to other OVC program",children:"Transferred to other OVC program"}),(0,E.jsx)(w.A.Option,{value:"Lost to follow-up",children:"Lost to follow-up"}),(0,E.jsx)(w.A.Option,{value:"Passed on",children:"Passed on"}),(0,E.jsx)(w.A.Option,{value:"Aging without transition plan",children:"Aging without transition plan"}),(0,E.jsx)(w.A.Option,{value:"Moved (Relocated)",children:"Moved (Relocated)"}),(0,E.jsx)(w.A.Option,{value:"Other",children:"Other"})]})})]})})]})]}),(0,E.jsx)(y.A,{children:(0,E.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,E.jsx)(T,{children:(0,E.jsxs)(x.A,{children:[(0,E.jsx)(m.A,{type:"primary",onClick:()=>{B(""),K(""),G(""),te(Object.keys(D).reduce((e,n)=>(0,c.A)((0,c.A)({},e),{},{[n]:"all"}),{})),ie([{key:"reason",value:""}]),J({}),ee(""),l(a);const e=a.map((e,n)=>({key:n,unique_id:e.uid,name:"".concat(e.firstname," ").concat(e.lastname),gender:e.vca_gender,age:re(e.birthdate),address:{homeaddress:e.homeaddress,facility:e.facility,province:e.province,district:e.district,ward:e.ward}}));C({data:e,pagination:L,loading:!1}),le.forEach(e=>{if("filterDropdown"in e){const n=e.filterDropdown;n.clearFilters&&n.clearFilters()}N.current&&N.current&&N.current.input&&(N.current.input.value="")})},children:I("Clear Filters")}),(0,E.jsx)(m.A,{type:"primary",onClick:()=>{try{const e=(new k.iX).parse(d),n=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");t.href=URL.createObjectURL(n),t.download="vca.csv",t.click()}catch(e){console.error("Error exporting data:",e)}},children:I("Export to CSV")})]})})})})]}),(0,E.jsx)(_.A,{title:"Filter Key Descriptions",open:$,onOk:()=>{X(!1)},onCancel:()=>{X(!1)},width:600,children:(0,E.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:Object.entries(F).map(e=>{let[n,t]=e;return(0,E.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,E.jsxs)(H,{strong:!0,children:[D[n],":"]}),(0,E.jsx)("br",{}),(0,E.jsx)(H,{children:t})]},n)})})}),(0,E.jsx)(u.W,{columns:le,dataSource:h.data,loading:P,scroll:{x:1e3},style:{overflowX:"auto"},onChange:e=>{C(n=>(0,c.A)((0,c.A)({},n),{},{pagination:e}))}})]})},B=()=>{const[e,n]=(0,i.useState)(null),[t,a]=(0,i.useState)(!0),[l,c]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{a(!0),await new Promise(e=>setTimeout(e,5e3));const e=await s().get("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BASE_URL,"/users/me"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});n(e.data.data)}catch(e){console.error("Error fetching user data:",e)}finally{a(!1),c(!1)}})()},[]);const h=(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(r.A.Title,{level:4,children:[" ",t?(0,E.jsx)(d.A.Input,{active:!0,size:"small"}):"".concat(null===e||void 0===e?void 0:e.location)," District VCAs Archived Register"]}),(0,E.jsx)(o.A,{color:"volcano",children:"Note: Only deregistered VCAs are shown."}),(0,E.jsx)("br",{}),(0,E.jsx)("br",{})]});return(0,E.jsxs)(E.Fragment,{children:[h,l?(0,E.jsx)(d.A,{active:!0,paragraph:{rows:2}}):(0,E.jsx)(W,{})]})}}}]);
//# sourceMappingURL=7932.4a501b50.chunk.js.map