"use strict";(self.webpackChunklightence_admin=self.webpackChunklightence_admin||[]).push([[3351],{26486(e,t,a){a.d(t,{N:()=>T});var n,l=a(89379),r=a(57528),i=a(65043),s=a(19160),o=a(74684),c=a(49092),d=a(64435),h=a(40854),u=a.n(h),p=a(73216),g=a(89421),x=a(11645),m=a(25389),y=a(47419),f=a(36497),A=a(8387),v=a(35696),j=a(62058),w=a(16854),S=a.n(w),C=a(94574),b=a(43286),_=a(83722),I=a(70579);const E={current:1,pageSize:100},k={calhiv:"all",hei:"all",cwlhiv:"all",agyw:"all",csv:"all",cfsw:"all",abym:"all"},D=C.Ay.div(n||(n=(0,r.A)(["\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: 16px;\n"]))),O={calhiv:"CALHIV",hei:"HEI",cwlhiv:"CWLHIV",agyw:"AGYW",csv:"C/SV",cfsw:"CFSW",abym:"ABYM"},T=()=>{const[e,t]=(0,i.useState)([]),[a,n]=(0,i.useState)([]),[r,h]=(0,i.useState)({data:[],pagination:E,loading:!1}),{t:w}=(0,c.B)(),[C,T]=(0,i.useState)(""),[F,L]=(0,i.useState)(null),R=(0,p.Zp)(),W=(0,i.useRef)(null),[N,H]=(0,i.useState)(""),[B,z]=(0,i.useState)(""),[P,V]=(0,i.useState)(k),[U,K]=(0,i.useState)({});(0,i.useEffect)(()=>{(async()=>{try{const e=await u().get("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BASE_URL,"/users/me"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});L(e.data.data)}catch(e){console.error("Error fetching user data:",e)}})()},[]),(0,i.useEffect)(()=>{(async()=>{if(F)try{h(e=>(0,l.A)((0,l.A)({},e),{},{loading:!0}));const e=await u().get("https://ecapplus.server.dqa.bluecodeltd.com/household/all-households/".concat(null===F||void 0===F?void 0:F.location));t(e.data.data)}catch(e){console.error("Error fetching households data:",e)}finally{h(e=>(0,l.A)((0,l.A)({},e),{},{loading:!1}))}})()},[F]);const Y=(e,t,a)=>{t(),H(e[0]),z(a)};(0,i.useEffect)(()=>{const t=e.filter(e=>{const t=!C||Object.values(e).some(e=>e&&e.toString().toLowerCase().includes(C.toLowerCase())),a=Object.entries(P).every(t=>{let[a,n]=t;if("all"===n)return!0;const l=e[a];return"yes"===n?"1"===l||"true"===l:"0"===l||"false"===l});return t&&a});n(t)},[C,N,B,e,P]),(0,i.useEffect)(()=>{const e=a.map((e,t)=>({key:t,name:e.caregiver_name,age:0,address:"\n        Address: ".concat(e.homeaddress||"Not Applicable","\n        Facility: ").concat(e.facility||"Not Applicable","\n        Province: ").concat(e.province||"Not Applicable","\n        District: ").concat(e.district||"Not Applicable","\n        Ward: ").concat(e.ward||"Not Applicable","\n      "),household_id:e.household_id,caseworker_name:e.caseworker_name}));h({data:e,pagination:E,loading:!1})},[a,N]);const q=e=>({filterDropdown:t=>{let{setSelectedKeys:a,selectedKeys:n,confirm:r,clearFilters:i,close:s}=t;return(0,I.jsxs)("div",{style:{padding:8},children:[(0,I.jsx)(m.A,{ref:W,placeholder:"Search ".concat(e),value:n[0],onChange:e=>a(e.target.value?[e.target.value]:[]),onPressEnter:()=>{Y(n,r,e),K(t=>(0,l.A)((0,l.A)({},t),{},{[e]:n[0]||""}))},style:{marginBottom:8,display:"block"}}),(0,I.jsxs)(d.A,{children:[(0,I.jsx)(g.A,{type:"primary",onClick:()=>{Y(n,r,e),K(t=>(0,l.A)((0,l.A)({},t),{},{[e]:n[0]||""}))},icon:(0,I.jsx)(j.A,{}),size:"small",style:{width:95},children:"Search"}),(0,I.jsx)(g.A,{type:"primary",size:"small",onClick:()=>{i&&((e=>{e(),H("")})(i),H(""),z(""),K(t=>{const a=(0,l.A)({},t);return delete a[e],a}),r({closeDropdown:!1}))},style:{width:130},children:"Reset column"}),(0,I.jsx)(g.A,{type:"link",size:"small",onClick:s,children:"X"})]})]})},filterIcon:e=>(0,I.jsx)(j.A,{style:{color:e?"#1890ff":void 0}}),onFilter:(t,a)=>{const n=e in a?a[e]:"";return null!==n&&(!!n&&String(n).toLowerCase().includes(String(t).toLowerCase()))},render:(t,a)=>{const n=U[e]||"";if("address"===e){const e=["Address: ".concat(a.homeaddress),"Facility: ".concat(a.facility),"Province: ".concat(a.province),"District: ".concat(a.district),"Ward: ".concat(a.ward)];return(0,I.jsx)("div",{children:e.map((e,t)=>(0,I.jsx)("div",{children:n?(0,I.jsx)(S(),{highlightStyle:{backgroundColor:"#FFC069",padding:0},searchWords:[n],autoEscape:!0,textToHighlight:e}):e},t))})}return n?(0,I.jsx)(S(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[n],autoEscape:!0,textToHighlight:t?t.toString():""}):t}}),G=[(0,l.A)({title:w("Household ID"),dataIndex:"household_id",width:"15%"},q("household_id")),(0,l.A)({title:w("Caregiver Name"),dataIndex:"name",width:"15%"},q("name")),(0,l.A)((0,l.A)({title:w("Household Details"),dataIndex:"address",width:"30%"},q("address")),{},{render:e=>(0,I.jsxs)("div",{style:{whiteSpace:"pre-line"},children:[" ",e," "]})}),(0,l.A)({title:w("Case Worker"),dataIndex:"caseworker_name",width:"15%"},q("caseworker_name")),{title:w("Applied Filters & Search"),dataIndex:"appliedFilters",width:"20%",render:()=>{const e=[...Object.entries(P).filter(e=>{let[,t]=e;return"all"!==t}).map(e=>{let[t]=e;return O[t]}),...Object.entries(U).filter(e=>{let[,t]=e;return""!==t}).map(e=>{let[t,a]=e;return"".concat(a)})];return(0,I.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:e.map((e,t)=>(0,I.jsx)(A.A,{color:"cyan",children:e},t))})}},{title:w("Actions"),width:"10%",render:(e,t)=>(0,I.jsx)(d.A,{children:(0,I.jsx)(o.S,{type:"primary",onClick:()=>M(t.household_id),children:w("View")})})}],M=t=>{const a=e.find(e=>e.household_id===t);R("/profile/household-profile/".concat(encodeURIComponent(t)),{state:{household:a}})};return(0,I.jsxs)("div",{children:[(0,I.jsxs)(y.A,{justify:"space-between",align:"middle",style:{marginBottom:"16px"},children:[(0,I.jsx)(x.A,{children:(0,I.jsx)(v.A,{title:w("You can search by Household ID, Caregiver Name, Caseworker Name, and other fields."),children:(0,I.jsx)(b.DO,{placeholder:w("Global Search"),value:C,onChange:e=>T(e.target.value),style:{marginRight:"16px"}})})}),(0,I.jsxs)(x.A,{span:24,children:[(0,I.jsxs)("h5",{style:{fontSize:"20px",margin:"16px 16px 8px 0"},children:[" ",w("Filter by Sub Population")," "]}),(0,I.jsx)(y.A,{align:"middle",style:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap"},children:Object.entries(O).map(e=>{let[t,a]=e;return(0,I.jsxs)("div",{style:{marginRight:"16px",marginBottom:"1px",display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[(0,I.jsxs)("span",{style:{fontSize:"12px"},children:[" ",a," "]}),(0,I.jsxs)(f.A,{style:{width:"100px"},value:P[t],onChange:e=>{return a=t,n=e,void V(e=>(0,l.A)((0,l.A)({},e),{},{[a]:n}));var a,n},children:[(0,I.jsxs)(f.A.Option,{value:"all",children:[" ",w("All")," "]}),(0,I.jsxs)(f.A.Option,{value:"yes",children:[" ",w("Yes")," "]}),(0,I.jsxs)(f.A.Option,{value:"no",children:[" ",w("No")," "]})]})]},t)})})]}),(0,I.jsx)(x.A,{children:(0,I.jsx)(D,{children:(0,I.jsxs)(d.A,{style:{marginTop:"20px"},children:[(0,I.jsx)(g.A,{type:"primary",onClick:()=>{H(""),T(""),z(""),V(k)},children:w("Clear Filters")}),(0,I.jsx)(g.A,{type:"primary",onClick:()=>{try{const e=(new _.iX).parse(a),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="households_data.csv",n.click()}catch(e){console.error("Error exporting data:",e)}},children:w("Export to CSV")})]})})})]}),(0,I.jsx)(s.W,{columns:G,dataSource:r.data,scroll:{x:1e3},pagination:r.pagination,loading:r.loading,style:{overflowX:"auto"},onChange:e=>{h(t=>(0,l.A)((0,l.A)({},t),{},{pagination:e}))}})]})}},83351(e,t,a){a.r(t),a.d(t,{default:()=>W});var n=a(65043),l=a(49092),r=a(89379),i=a(19160),s=a(74684),o=a(40854),c=a.n(o),d=a(25389),h=a(64435),u=a(89421),p=a(47419),g=a(11645),x=a(35696),m=a(36497),y=a(62058),f=a(16854),A=a.n(f),v=a(43286),j=a(73216),w=a(70579);const S={current:1,pageSize:100},C=()=>{const[e,t]=(0,n.useState)([]),[a,o]=(0,n.useState)({data:[],pagination:S,loading:!1}),{t:f}=(0,l.B)(),[C,b]=(0,n.useState)(""),[_,I]=(0,n.useState)(!1),[E,k]=(0,n.useState)(null),D=(0,n.useRef)(null),O=(0,j.Zp)(),[T,F]=(0,n.useState)(""),[L,R]=(0,n.useState)(""),[W,N]=(0,n.useState)({calhiv:"all",hei:"all",cwlhiv:"all",agyw:"all",csv:"all",cfsw:"all",abym:"all"});(0,n.useEffect)(()=>{(async()=>{try{const e=await c().get("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BASE_URL,"/users/me"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});k(e.data.data)}catch(e){console.error("Error fetching user data:",e)}})()},[]),(0,n.useEffect)(()=>{(async()=>{if(E)try{I(!0);const e=await c().get("https://ecapplus.server.dqa.bluecodeltd.com/child/household-members-register");t(e.data.data)}catch(e){console.error("Error fetching VCAs data:",e)}finally{I(!1)}})()},[E]),(0,n.useEffect)(()=>{const t=C.toLowerCase(),a=e.filter(e=>{var a,n,l,r,i,s;const o=((null===(a=e.uid)||void 0===a?void 0:a.toLowerCase())||"").includes(t)||((null===(n=e.firstname)||void 0===n?void 0:n.toLowerCase())||"").includes(t)||((null===(l=e.lastname)||void 0===l?void 0:l.toLowerCase())||"").includes(t)||((null===(r=e.homeaddress)||void 0===r?void 0:r.toLowerCase())||"").includes(t)||((null===(i=e.ward)||void 0===i?void 0:i.toLowerCase())||"").includes(t)||((null===(s=e.vca_gender)||void 0===s?void 0:s.toLowerCase())||"").includes(t),c=Object.entries(W).every(t=>{let[a,n]=t;if("all"===n)return!0;const l=e[a];return null!==l&&("yes"===n?"1"===l||"true"===l:"0"===l||"false"===l)});return o&&c}).map((e,t)=>({key:t,unique_id:e.uid,name:"".concat(e.firstname," ").concat(e.lastname),gender:e.vca_gender,age:H(e.birthdate),address:"".concat(e.homeaddress||"",", ").concat(e.facility||"",", ").concat(e.province||"Unknown",", ").concat(e.district||"",", ").concat(e.ward||"")}));o({data:a,pagination:S,loading:!1})},[C,e,W]);const H=e=>{if(!e)return 0;const t=[/^(\d{1,2})-(\d{1,2})-(\d{4})$/,/^(\d{4})-(\d{1,2})-(\d{1,2})$/,/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/];let a=null;for(const i of t){const n=e.match(i);if(n){a=i===t[0]?new Date(parseInt(n[3]),parseInt(n[2])-1,parseInt(n[1])):i===t[1]?new Date(parseInt(n[1]),parseInt(n[2])-1,parseInt(n[3])):new Date(parseInt(n[3]),parseInt(n[1])-1,parseInt(n[2]));break}}if(!a||isNaN(a.getTime()))return console.warn("Invalid date format: ".concat(e)),0;const n=new Date;let l=n.getFullYear()-a.getFullYear();const r=n.getMonth()-a.getMonth();return(r<0||0===r&&n.getDate()<a.getDate())&&l--,l},B=(e,t,a)=>{t(),F(e[0]),R(a)},z=e=>({filterDropdown:t=>{let{setSelectedKeys:a,selectedKeys:n,confirm:l,clearFilters:r,close:i}=t;return(0,w.jsxs)("div",{style:{padding:8},children:[(0,w.jsx)(d.A,{ref:D,placeholder:"Search ".concat(e),value:n[0],onChange:e=>a(e.target.value?[e.target.value]:[]),onPressEnter:()=>B(n,l,e),style:{marginBottom:8,display:"block"}}),(0,w.jsxs)(h.A,{children:[(0,w.jsx)(u.A,{type:"primary",onClick:()=>B(n,l,e),icon:(0,w.jsx)(y.A,{}),size:"small",style:{width:90},children:"Search"}),(0,w.jsx)(u.A,{onClick:()=>r&&(e=>{e(),F("")})(r),size:"small",style:{width:90},children:"Clear"}),(0,w.jsx)(u.A,{type:"link",size:"small",onClick:()=>{l({closeDropdown:!1}),F(String(n[0])),R(e)},children:"Reset table"}),(0,w.jsx)(u.A,{type:"link",size:"small",onClick:i,children:"Close"})]})]})},filterIcon:e=>(0,w.jsx)(y.A,{style:{color:e?"#1890ff":void 0}}),onFilter:(t,a)=>{const n=a[e];return!!n&&String(n).toLowerCase().includes(String(t).toLowerCase())},onFilterDropdownVisibleChange:e=>{e&&setTimeout(()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.select()},100)},render:t=>L===e?(0,w.jsx)(A(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[T],autoEscape:!0,textToHighlight:t?t.toString():""}):t}),P=[(0,r.A)({title:f("Unique ID"),dataIndex:"unique_id",width:"15%"},z("unique_id")),(0,r.A)({title:f("Full Name"),dataIndex:"name",width:"20%"},z("name")),(0,r.A)({title:f("Gender"),dataIndex:"gender",width:"10%"},z("gender")),(0,r.A)({title:f("Age"),dataIndex:"age",width:"10%"},z("age")),(0,r.A)({title:f("Household Details"),dataIndex:"address",width:"35%"},z("address")),{title:f("Actions"),width:"10%",dataIndex:"",render:(t,a)=>(0,w.jsx)(s.S,{type:"primary",onClick:()=>(t=>{const a=e.find(e=>e.uid===t);O("/profile/member-profile/".concat(encodeURIComponent(t)),{state:{vca:a}})})(a.unique_id),children:f("View")})}];return(0,w.jsxs)("div",{children:[(0,w.jsxs)(p.A,{justify:"space-between",align:"middle",style:{marginBottom:"16px"},children:[(0,w.jsx)(g.A,{children:(0,w.jsx)(x.A,{title:f("You can search by Household ID, Caregiver Name, Caseworker Name, and other fields."),children:(0,w.jsx)(v.DO,{placeholder:f("Global Search"),value:C,onChange:e=>b(e.target.value),style:{marginRight:"16px"}})})}),(0,w.jsxs)(g.A,{span:24,children:[(0,w.jsx)("h5",{style:{fontSize:"20px",margin:"16px 16px 8px 0"},children:f("Filter by Sub Population")}),(0,w.jsx)(p.A,{align:"middle",style:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap"},children:Object.entries({calhiv:"CALHIV",hei:"HEI",cwlhiv:"CWLHIV",agyw:"AGYW",csv:"CSV",cfsw:"CFSW",abym:"ABYM"}).map(e=>{let[t,a]=e;return(0,w.jsxs)("div",{style:{marginRight:"16px",marginBottom:"1px",display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[(0,w.jsx)("span",{style:{fontSize:"12px"},children:a}),(0,w.jsxs)(m.A,{style:{width:"100px"},value:W[t],onChange:e=>{return a=t,n=e,void N(e=>(0,r.A)((0,r.A)({},e),{},{[a]:n}));var a,n},children:[(0,w.jsx)(m.A.Option,{value:"all",children:f("All")}),(0,w.jsx)(m.A.Option,{value:"yes",children:f("Yes")}),(0,w.jsx)(m.A.Option,{value:"no",children:f("No")})]})]},t)})})]})]}),(0,w.jsx)(i.W,{columns:P,dataSource:a.data,pagination:a.pagination,loading:_})]})};var b,_,I=a(88478),E=a(26486),k=a(57528),D=a(94574),O=a(19130);const T=D.Ay.div(b||(b=(0,k.A)(["\n  margin-top: 1.875rem;\n"]))),F=(0,D.Ay)(O.a)(_||(_=(0,k.A)(["\n  margin-bottom: 2rem;\n"]))),L=()=>{const{t:e}=(0,l.B)();return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(T,{children:[(0,w.jsx)(F,{id:"basic-table",title:e("tables.basicTable"),padding:"1.25rem 1.25rem 0",children:(0,w.jsx)(C,{})}),(0,w.jsx)(F,{id:"tree-table",title:e("tables.treeTable"),padding:"1.25rem 1.25rem 0",children:(0,w.jsx)(I.z,{})}),(0,w.jsx)(F,{id:"editable-table",title:e("tables.editableTable"),padding:"1.25rem 1.25rem 0",children:(0,w.jsx)(E.N,{})})]})})};var R=a(48670);const W=()=>{const{t:e}=(0,l.B)();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(R.s,{children:e("common.dataTables")}),(0,w.jsx)(L,{})]})}}}]);
//# sourceMappingURL=3351.c87da6cb.chunk.js.map